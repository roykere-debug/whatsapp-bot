# מדריך פריסה ללקוח - WhatsApp Bot

## 📋 סקירה כללית

מדריך זה מסביר איך להעביר את הבוט ללקוח שלך, כולל:
- פריסה על Railway (שרת ענן)
- גישה לדשבורד
- הגדרות אבטחה (רק צ'אטים פרטיים + רק המספר שלך)
- איך השרת נשאר פעיל תמיד

---

## 🔒 הגדרות אבטחה

### הבוט מוגן בכמה שכבות:

1. **רק צ'אטים פרטיים** - הבוט **תמיד** מתעלם מקבוצות WhatsApp
2. **רק המספר שלך** - הבוט עובד רק עם המספר `972549762201`
3. **דשבורד לשליטה** - אפשר להפעיל/לכבות את הבוט בכל עת

**מה זה אומר:**
- ✅ הבוט יעבוד רק בצ'אטים פרטיים (1 על 1) עם המספר שלך
- ❌ הבוט **לא** יעבוד בקבוצות (אפילו אם אתה בקבוצה)
- ❌ הבוט **לא** יעבוד עם מספרים אחרים

---

## 🚀 שלב 1: פריסה על Railway

### מה זה Railway?
Railway הוא שירות ענן שמריץ את הבוט שלך 24/7. השרת נשאר פעיל תמיד, גם כשהמחשב שלך כבוי.

### איך מפרסים:

1. **העלה את הקוד ל-GitHub:**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git remote add origin YOUR_GITHUB_REPO_URL
   git push -u origin main
   ```

2. **היכנס ל-Railway:**
   - לך ל-https://railway.app
   - היכנס עם GitHub
   - לחץ על "New Project"
   - בחר "Deploy from GitHub repo"
   - בחר את ה-repository שלך

3. **הוסף משתני סביבה (Environment Variables):**
   - `GREEN_API_INSTANCE_ID` - מספר ה-instance מ-Green API
   - `GREEN_API_TOKEN` - הטוקן מ-Green API
   - `DATABASE_URL` - Railway יוצר את זה אוטומטית (לא צריך להגדיר)
   - **אל תגדיר** `TEST_USER_PHONE` - המספר כבר מוגדר בקוד (972549762201)

4. **הוסף PostgreSQL Database:**
   - ב-Railway, לחץ על "New" → "Database" → "PostgreSQL"
   - Railway יוצר את ה-`DATABASE_URL` אוטומטית

5. **קבל את ה-URL של השרת:**
   - Railway יתן לך URL כמו: `https://your-app.up.railway.app`
   - שמור את זה!

---

## 🔗 שלב 2: הגדרת Webhook ב-Green API

1. **היכנס ל-Green API Dashboard:**
   - https://console.green-api.com

2. **הגדר Webhook:**
   - לך ל-"Notifications" או "Webhooks"
   - הכנס את ה-URL: `https://your-app.up.railway.app/webhook/greenapi`
   - שמור

---

## 🎛️ שלב 3: גישה לדשבורד

### איך הלקוח יגיע לדשבורד:

**הכתובת לדשבורד:**
```
https://your-app.up.railway.app/dashboard
```

**מה הלקוח יכול לעשות:**
- ✅ לראות אם הבוט פעיל או כבוי
- ✅ להפעיל/לכבות את הבוט בלחיצה אחת
- ✅ לקבל עדכונים בזמן אמת

**חשוב:** הדשבורד פתוח לכל מי שיש לו את הקישור. אם אתה רוצה אבטחה נוספת, אפשר להוסיף authentication (זה דורש שינויים בקוד).

---

## ⚙️ שלב 4: איך השרת נשאר פעיל תמיד?

### Railway - שירות ענן:

1. **Railway מריץ את השרת על שרתים שלהם:**
   - השרתים שלהם פעילים 24/7
   - לא תלוי במחשב שלך או בלקוח

2. **Auto-restart:**
   - אם השרת קורס, Railway מפעיל אותו מחדש אוטומטית
   - אם יש שגיאה, Railway מנסה לתקן

3. **Health Checks:**
   - Railway בודק כל כמה זמן שהשרת עובד
   - אם השרת לא עונה, Railway מפעיל אותו מחדש

4. **Logs:**
   - כל הלוגים נשמרים ב-Railway
   - אפשר לראות מה קורה בזמן אמת

### מה קורה כשהשרת נכבה?

**Railway מפעיל אותו מחדש אוטומטית!** זה לוקח כמה שניות, אבל זה קורה אוטומטית.

---

## 📝 שלב 5: העברת הפרויקט ללקוח

### מה הלקוח צריך:

1. **גישה לדשבורד:**
   ```
   https://your-app.up.railway.app/dashboard
   ```

2. **הסבר קצר:**
   - "הבוט עובד אוטומטית 24/7"
   - "אפשר להפעיל/לכבות מהדשבורד"
   - "הבוט עובד רק בצ'אטים פרטיים עם המספר שלך (972549762201)"
   - "הבוט לא יעבוד בקבוצות - זה בטוח"

3. **Green API Account:**
   - הלקוח צריך חשבון Green API
   - הוא צריך להגדיר את ה-webhook (או שאתה עושה את זה)

### מה אתה צריך לשמור לעצמך:

- ✅ גישה ל-Railway (לניהול השרת)
- ✅ גישה ל-GitHub (לעדכוני קוד)
- ✅ גישה ל-Green API (לניהול ה-instance)

---

## 💰 עלויות Railway

**Free Tier:**
- $5 credit בחינם כל חודש
- מספיק לרוב המקרים

**Paid Plans:**
- מתחיל מ-$5/חודש
- תלוי בשימוש (CPU, RAM, Bandwidth)

**טיפ:** התחל עם Free Tier ותראה כמה זה עולה. רוב הבוטים הקטנים נשארים בחינם.

---

## 🔧 תחזוקה

### איך לעדכן את הקוד:

1. **עדכן את הקוד ב-GitHub:**
   ```bash
   git add .
   git commit -m "Update"
   git push
   ```

2. **Railway יבנה מחדש אוטומטית:**
   - Railway מזהה שינויים ב-GitHub
   - בונה ומפעיל מחדש אוטומטית
   - אין צורך לעשות כלום!

### איך לראות לוגים:

1. היכנס ל-Railway
2. בחר את הפרויקט
3. לחץ על "Deployments" → בחר את ה-deployment האחרון
4. לחץ על "View Logs"

---

## 🔍 בדיקות

### איך לבדוק שהכל עובד:

1. **בדוק את Health Check:**
   ```
   https://your-app.up.railway.app/health
   ```
   צריך להחזיר: `{"status":"ok",...}`

2. **בדוק את הדשבורד:**
   ```
   https://your-app.up.railway.app/dashboard
   ```
   צריך לראות את הממשק עם כפתור הפעלה/כיבוי

3. **בדוק את הלוגים ב-Railway:**
   - צריך לראות הודעות כמו `[STARTUP] Starting WhatsApp Bot server...`
   - צריך לראות `✅ SERVER STARTED SUCCESSFULLY`

4. **שלח הודעה לבוט:**
   - שלח הודעה מ-WhatsApp מהמספר שלך (972549762201)
   - הבוט צריך להגיב
   - בדוק את הלוגים ב-Railway - צריך לראות את ההודעה

---

## ❓ שאלות נפוצות

### Q: מה קורה אם Railway נפל?
**A:** Railway הוא שירות יציב מאוד. אם יש בעיה, הם מטפלים בה מהר. יש להם SLA של 99.9% uptime.

### Q: איך אני יודע שהבוט עובד?
**A:** 
- בדוק את הדשבורד - אם הוא נטען, השרת עובד
- בדוק את הלוגים ב-Railway
- שלח הודעה לבוט ותראה אם הוא עונה

### Q: איך אני משנה משהו בקוד?
**A:**
1. עדכן את הקוד ב-GitHub
2. Railway יבנה מחדש אוטומטית
3. זה לוקח 1-2 דקות

### Q: מה אם הלקוח רוצה אבטחה נוספת לדשבורד?
**A:** אפשר להוסיף authentication (username/password). זה דורש שינויים בקוד - אני יכול לעזור עם זה.

### Q: איך אני משנה את המספר המורשה?
**A:** המספר מוגדר בקוד ב-`src/router.ts` בשורה 13. אפשר לשנות את זה או להגדיר משתנה סביבה `TEST_USER_PHONE`.

### Q: מה אם אני רוצה שהבוט יעבוד עם מספרים נוספים?
**A:** צריך לשנות את הקוד ב-`src/router.ts` - להוסיף רשימה של מספרים מורשים במקום בדיקה של מספר אחד.

---

## 📞 תמיכה

אם יש בעיות:
1. בדוק את הלוגים ב-Railway
2. בדוק את ה-Health Check: `https://your-app.up.railway.app/health`
3. בדוק את ה-Webhook ב-Green API
4. בדוק שהמשתנים ב-Railway מוגדרים נכון

---

## ✅ סיכום - מה הלקוח מקבל:

1. **בוט WhatsApp** שעובד 24/7
2. **דשבורד** לשליטה בבוט (`/dashboard`)
3. **אבטחה מלאה:**
   - רק צ'אטים פרטיים
   - רק המספר שלך (972549762201)
   - לא עובד בקבוצות
4. **שרת יציב** על Railway
5. **לוגים** לניטור

---

**🎉 זה הכל! הבוט מוכן לפריסה!**
